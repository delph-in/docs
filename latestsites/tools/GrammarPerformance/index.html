<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>DELPH-IN</title>
<meta name="description" content="DELPH-IN Documentation">


  <meta name="author" content="DELPH-IN">
  


<meta property="og:type" content="website">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="DELPH-IN">
<meta property="og:title" content="DELPH-IN">
<meta property="og:url" content="https://delph-in.github.io/docs/tools/GrammarPerformance/">


  <meta property="og:description" content="DELPH-IN Documentation">











  

  


<link rel="canonical" href="https://delph-in.github.io/docs/tools/GrammarPerformance/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "DELPH-IN",
      "url": "https://delph-in.github.io/docs/tools/"
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/docs/tools/feed.xml" type="application/atom+xml" rel="alternate" title="DELPH-IN Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/docs/tools/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--delphin_page wide">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/docs/tools/"><img src="/docs/tools/assets/images/Delph-In.png" alt="DELPH-IN"></a>
        
        <a class="site-title" href="/docs/tools/">
          DELPH-IN
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="https://delph-in.github.io/docs/home/Home">Home</a>
            </li><li class="masthead__menu-item">
              <a href="https://delph-in.github.io/docs/howto/DelphinWelcome">How-To</a>
            </li><li class="masthead__menu-item">
              <a href="https://delph-in.github.io/docs/erg/ErgTop">ERG</a>
            </li><li class="masthead__menu-item">
              <a href="https://delph-in.github.io/docs/tools/ToolsTop">Tools</a>
            </li><li class="masthead__menu-item">
              <a href="https://delph-in.github.io/docs/grammars/GrammarsOverview">Grammars</a>
            </li><li class="masthead__menu-item">
              <a href="https://delph-in.github.io/docs/matrix/MatrixDocsOverview">Matrix</a>
            </li><li class="masthead__menu-item">
              <a href="https://delph-in.github.io/docs/summits/SummitTop">Summits</a>
            </li><li class="masthead__menu-item">
              <a href="https://delph-in.github.io/docs/garage/GarageTop">Garage</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      





<div id="main" role="main">
  
  <div class="sidebar sticky">
  
  
    
      
      
      
      
    
    
      

<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">Toggle Menu</label>
  <ul class="nav__items">
    
      <li>
        
          <span class="nav__sub-title">Tools</span>
        

        
        <ul>
          
            <li><a href="/docs/tools/ToolsTop/">Overview</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">PyDelphin</span>
        

        
        <ul>
          
            <li><a href="/docs/tools/PyDelphinTop/">Overview</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">LKB</span>
        

        
        <ul>
          
            <li><a href="/docs/tools/LkbTop/">Overview</a></li>
          
            <li><a href="/docs/tools/LkbInstallation/">Installation</a></li>
          
            <li><a href="/docs/tools/LkbFos/">Fully Open Source Version</a></li>
          
            <li><a href="/docs/tools/LkbMacintosh/">Macintosh Version</a></li>
          
            <li><a href="/docs/tools/LkbCourses/">Courses</a></li>
          
            <li><a href="/docs/tools/LkbConventions/">Conventions</a></li>
          
            <li><a href="/docs/tools/LkbGeneration/">Generation</a></li>
          
            <li><a href="/docs/tools/LkbCompilation/">Compilation</a></li>
          
            <li><a href="/docs/tools/LkbEmacs/">Emacs</a></li>
          
            <li><a href="/docs/tools/LkbTrollet/">Trollet</a></li>
          
            <li><a href="/docs/tools/LkbSppp/">Simple PreProcessor Protocol</a></li>
          
            <li><a href="/docs/tools/RmrsVpm/">Variable Property Mapping (VPM)</a></li>
          
            <li><a href="/docs/tools/LkbLpconstraints/">LkbLpconstraints</a></li>
          
            <li><a href="/docs/tools/LkbUserGroup/">User Group</a></li>
          
            <li><a href="/docs/tools/LkbFaq/">FAQ</a></li>
          
            <li><a href="/docs/tools/LkbMode/">Emacs FAQ</a></li>
          
            <li><a href="/docs/tools/LkbWishlist/">Wish list</a></li>
          
            <li><a href="/docs/tools/LkbBugs/">Bugs</a></li>
          
            <li><a href="/docs/tools/LkbCopyright/">Copyright</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">ACE Parser</span>
        

        
        <ul>
          
            <li><a href="/docs/tools/AceTop/">Overview</a></li>
          
            <li><a href="/docs/tools/AceInstall/">Install</a></li>
          
            <li><a href="/docs/tools/AceConfiguration/">Configuration</a></li>
          
            <li><a href="/docs/tools/AceOptions/">Options</a></li>
          
            <li><a href="/docs/tools/AceUse/">Examples</a></li>
          
            <li><a href="/docs/tools/AceLui/">LUI Mode</a></li>
          
            <li><a href="/docs/tools/AceCsaw/">Csaw</a></li>
          
            <li><a href="/docs/tools/AceTransfer/">Transfer</a></li>
          
            <li><a href="/docs/tools/AceExperimental/">Experimental</a></li>
          
            <li><a href="/docs/tools/AceFaq/">Faq</a></li>
          
            <li><a href="/docs/tools/AceWishlist/">Wish list</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">LKB LUI</span>
        

        
        <ul>
          
            <li><a href="/docs/tools/LkbLui/">Overview</a></li>
          
            <li><a href="/docs/tools/LuiRc/">User Configuration</a></li>
          
            <li><a href="/docs/tools/LuiUi/">UI Quick Reference</a></li>
          
            <li><a href="/docs/tools/LuiTree/">Tree</a></li>
          
            <li><a href="/docs/tools/LuiAvm/">Feature Structure (AVM)</a></li>
          
            <li><a href="/docs/tools/LuiUnification/">Unification</a></li>
          
            <li><a href="/docs/tools/LuiMrs/">MRS Display</a></li>
          
            <li><a href="/docs/tools/LuiChart/">Chart Browser</a></li>
          
            <li><a href="/docs/tools/LuiWishlist/">Wish list</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">LKB LexDB</span>
        

        
        <ul>
          
            <li><a href="/docs/tools/LexDbSimplePsql/">Simple PSQL</a></li>
          
            <li><a href="/docs/tools/LexDbInitialize/">Initialization</a></li>
          
            <li><a href="/docs/tools/LexDbPsqlInitialize/">PSQL Initialization</a></li>
          
            <li><a href="/docs/tools/LexDbFieldMappings/">Field Mappings</a></li>
          
            <li><a href="/docs/tools/LkbLexDbMultiUser/">Multi-User</a></li>
          
            <li><a href="/docs/tools/LkbLexDbSingleUser/">Single User</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">[incr tsdb()]</span>
        

        
        <ul>
          
            <li><a href="/docs/tools/ItsdbTop/">Overview</a></li>
          
            <li><a href="/docs/tools/TsdbTop/">Deep Dive</a></li>
          
            <li><a href="/docs/tools/ItsdbDerivations/">Derivations</a></li>
          
            <li><a href="/docs/tools/ItsdbProfileManipulation/">Profile Manipulation</a></li>
          
            <li><a href="/docs/tools/ItsdbProfile/">Profile</a></li>
          
            <li><a href="/docs/tools/ItsdbProfiling/">Profiling</a></li>
          
            <li><a href="/docs/tools/ItsdbDistributedProcessing/">Distributed Processing</a></li>
          
            <li><a href="/docs/tools/ItsdbBatch/">Batch</a></li>
          
            <li><a href="/docs/tools/ItsdbReference/">Reference</a></li>
          
            <li><a href="/docs/tools/ItsdbTroubleshooting/">Troubleshooting</a></li>
          
            <li><a href="/docs/tools/GeFaqTsdbRc/">FAQ</a></li>
          
            <li><a href="/docs/tools/ItsdbWishlist/">Wish List</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Logon</span>
        

        
        <ul>
          
            <li><a href="/docs/tools/LogonTop/">Overview</a></li>
          
            <li><a href="/docs/tools/LogonInstallation/">Installation</a></li>
          
            <li><a href="/docs/tools/LogonRedhat/">Red Hat</a></li>
          
            <li><a href="/docs/tools/LogonUbuntu/">Ubuntu</a></li>
          
            <li><a href="/docs/tools/LogonArch/">Arch Linux</a></li>
          
            <li><a href="/docs/tools/LogonDebian/">Debian</a></li>
          
            <li><a href="/docs/tools/LogonHandon/">Hands-On Release</a></li>
          
            <li><a href="/docs/tools/LogonSvn/">SVN</a></li>
          
            <li><a href="/docs/tools/LogonProcessing_BatchGeneration/">Batch Generation</a></li>
          
            <li><a href="/docs/tools/LogonProcessing_BatchTranslation/">Batch Translation</a></li>
          
            <li><a href="/docs/tools/LogonPet/">PET Integration</a></li>
          
            <li><a href="/docs/tools/LogonAnswer/">ACE Integration</a></li>
          
            <li><a href="/docs/tools/LogonExtras/">Extras</a></li>
          
            <li><a href="/docs/tools/LogonReports/">Reports</a></li>
          
            <li><a href="/docs/tools/LogonProcessing/">Processing</a></li>
          
            <li><a href="/docs/tools/LogonProcessing_BatchParsing/">Batch Parsing</a></li>
          
            <li><a href="/docs/tools/LogonModeling/">Modeling</a></li>
          
            <li><a href="/docs/tools/LogonOnline/">Online</a></li>
          
            <li><a href="/docs/tools/LogonTransfer/">Transfer</a></li>
          
            <li><a href="/docs/tools/LogonVpm/">Variable Property Mapping</a></li>
          
            <li><a href="/docs/tools/NoJa/">Setting up New Languages</a></li>
          
            <li><a href="/docs/tools/LogonIdiosyncrasies/">Idiosyncrasies</a></li>
          
            <li><a href="/docs/tools/LogonWishlist/">Wishlist</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Grammar Tips</span>
        

        
        <ul>
          
            <li><a href="/docs/tools/GrammarPerformance/" class="active">Grammar Performance</a></li>
          
            <li><a href="/docs/tools/VersionControlForGrammarDevelopment/">Grammar Version Control</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Treebanking</span>
        

        
        <ul>
          
            <li><a href="/docs/tools/TreebankingTop/">Overview</a></li>
          
            <li><a href="/docs/tools/FftbTop/">Full Forest Treebanker (FFTB)</a></li>
          
            <li><a href="/docs/tools/FftbTreebankUpdateTutorial/">FFTB Treebank Update Tutorial</a></li>
          
            <li><a href="/docs/tools/FftbWishlist/">Full Forest Treebanker Wishlist</a></li>
          
            <li><a href="/docs/tools/ItsdbTreebanking/">[incr tsdb()] Treebanking</a></li>
          
            <li><a href="/docs/tools/ItsdbTreebanking_ItsdbAnnotation/">[incr tsdb()] Treebanking Annotation</a></li>
          
            <li><a href="/docs/tools/ItsdbTreebanking_ItsdbUpdating/">[incr tsdb()] Treebanking Updating</a></li>
          
            <li><a href="/docs/tools/ItsdbTreebanking_ItsdbExporting/">[incr tsdb()] Treebanking Exporting</a></li>
          
            <li><a href="/docs/tools/ItsdbTreebanking_ItsdbModeling/">[incr tsdb()] Treebanking Modeling</a></li>
          
            <li><a href="/docs/tools/ItsdbTreebanking_ItsdbUpdating/">[incr tsdb()] Treebanking Updating</a></li>
          
            <li><a href="/docs/tools/ItsdbCustomization/">[incr tsdb()] Treebanking Customization</a></li>
          
            <li><a href="/docs/tools/ItsdbTreebanking_ItsdbModeling/">[incr tsdb()] Treebanking Modeling</a></li>
          
            <li><a href="/docs/tools/IndraTreebanking/">Indra</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Formats</span>
        

        
        <ul>
          
            <li><a href="/docs/tools/DelphinRFCs/">Delphin RFCs</a></li>
          
            <li><a href="/docs/tools/PredicateRfc/">Predicate RFC</a></li>
          
            <li><a href="/docs/tools/MrsRFC/">MRS Format RFC</a></li>
          
            <li><a href="/docs/tools/MrsIsomorphism/">MRS Isomorphism</a></li>
          
            <li><a href="/docs/tools/EdsTop/">EDS Format</a></li>
          
            <li><a href="/docs/tools/EdsConversion/">EDS Conversion</a></li>
          
            <li><a href="/docs/tools/EdsGeneration/">EDS Generation</a></li>
          
            <li><a href="/docs/tools/SemiRfc/">SEM-I RFC</a></li>
          
            <li><a href="/docs/tools/TdlRFC/">TDL RFC</a></li>
          
            <li><a href="/docs/tools/TsqlRfc/">TSQL RFC</a></li>
          
            <li><a href="/docs/tools/GrammarVersionRfc/">Grammar Version RFC</a></li>
          
            <li><a href="/docs/tools/GrammarConfigurationRfc/">Grammar Configuration RFC</a></li>
          
            <li><a href="/docs/tools/TsdbSchemaRfc/">TSDB Schema RFC</a></li>
          
            <li><a href="/docs/tools/MatrixChoicesRfc/">Matrix Choices RFC</a></li>
          
            <li><a href="/docs/tools/RmrsTop/">(R)MRS Overview</a></li>
          
            <li><a href="/docs/tools/RmrsWellformedness/">(R)MRS Wellformedness</a></li>
          
            <li><a href="/docs/tools/RmrsPos/">(R)MRS Predicate Naming</a></li>
          
            <li><a href="/docs/tools/RmrsSpan/">(R)MRS Span</a></li>
          
            <li><a href="/docs/tools/RmrsDesign/">(R)MRS Design</a></li>
          
            <li><a href="/docs/tools/RmrsParaphrasing/">(R)MRS Paraphrasing</a></li>
          
            <li><a href="/docs/tools/RmrsModel/">(R)MRS Model</a></li>
          
            <li><a href="/docs/tools/RmrsDistributional/">(R)MRS Distributional</a></li>
          
            <li><a href="/docs/tools/RmrsSemi/">(R)MRS Semi</a></li>
          
            <li><a href="/docs/tools/RmrsDmrs/">(R)MRS Dmrs</a></li>
          
            <li><a href="/docs/tools/RmrsFaq/">(R)MRS Faq</a></li>
          
            <li><a href="/docs/tools/RmrsDiscussions/">(R)MRS Discussions</a></li>
          
            <li><a href="/docs/tools/TransferRules/">Transfer Rules</a></li>
          
            <li><a href="/docs/tools/FormatSpecifications/">Format Specifications</a></li>
          
            <li><a href="/docs/tools/ErgGml/">Grammar Markup Language</a></li>
          
            <li><a href="/docs/tools/SmafTop/">SMAF</a></li>
          
            <li><a href="/docs/tools/SmafLkb/">SMAF in LKB</a></li>
          
            <li><a href="/docs/tools/SmafPet/">SMAF in PET</a></li>
          
            <li><a href="/docs/tools/SmafSample/">SMAF Sample</a></li>
          
            <li><a href="/docs/tools/SmafDtd/">SMAF DTD</a></li>
          
            <li><a href="/docs/tools/SafTop/">SAF Overview</a></li>
          
            <li><a href="/docs/tools/SafDtd/">SAF DTD</a></li>
          
            <li><a href="/docs/tools/IconsSpecs/">Icons Specs</a></li>
          
        </ul>
        
      </li>
    
  </ul>
</nav>

    
  
  </div>



  <article class="page h-entry" itemscope itemtype="https://schema.org/CreativeWork">
    
    
    
    

    <div class="page__inner-wrap">
      
        <header>
          


        </header>
      

      <section class="page__content e-content" itemprop="text">
        
        
<p>There are several ways to increase the performance of DELPH-IN
grammars during parsing and generation.</p>

<p>This page attempts to give a rough idea of how to tweak your grammar
for better performance. As people add new techniques, please link them
here.</p>

<p>This page aims to document DELPH-IN techniques. It was started by
Francis, inspired by the <a href="https://delph-in.github.io/docs/summits/CapitolHillTop">Capitol Hill Grammar
Engineering Meeting</a> and based on a page originally
written for Jacy (<a href="https://delph-in.github.io/docs/grammars/JacyPerformance">JacyPerformance</a>).</p>

<!-- markdown-toc start - Don't edit this section. Run M-x markdown-toc-refresh-toc -->

<p><strong>Table of Contents</strong></p>

<ul>
  <li><a href="https://delph-in.github.io/docs/tools/GrammarPerformance#things-to-tweak-for-overall-performance">Things to tweak for overall performance</a>
    <ul>
      <li><a href="https://delph-in.github.io/docs/tools/GrammarPerformance#quick-check">Quick Check</a>
        <ul>
          <li><a href="https://delph-in.github.io/docs/tools/GrammarPerformance#pet">PET</a></li>
          <li><a href="https://delph-in.github.io/docs/tools/GrammarPerformance#ace">ACE</a></li>
          <li><a href="https://delph-in.github.io/docs/tools/GrammarPerformance#lkb">LKB</a></li>
          <li><a href="https://delph-in.github.io/docs/tools/GrammarPerformance#todo">ToDo</a></li>
        </ul>
      </li>
      <li><a href="https://delph-in.github.io/docs/tools/GrammarPerformance#key-arguments">Key Arguments</a>
        <ul>
          <li><a href="https://delph-in.github.io/docs/tools/GrammarPerformance#todo-1">ToDo</a></li>
        </ul>
      </li>
      <li><a href="https://delph-in.github.io/docs/tools/GrammarPerformance#spanning-only-rules">Spanning Only Rules</a></li>
      <li><a href="https://delph-in.github.io/docs/tools/GrammarPerformance#trigger-rules-for-generation">Trigger Rules for Generation</a></li>
      <li><a href="https://delph-in.github.io/docs/tools/GrammarPerformance#dont-copy-things-you-wont-use">Don’t copy things you won’t use</a></li>
      <li><a href="https://delph-in.github.io/docs/tools/GrammarPerformance#ubertagging">Ubertagging</a></li>
    </ul>
  </li>
  <li><a href="https://delph-in.github.io/docs/tools/GrammarPerformance#things-to-do-to-reduce-noise-during-grammar-engineering">Things to do to reduce noise during grammar engineering</a></li>
  <li><a href="https://delph-in.github.io/docs/tools/GrammarPerformance#things-that-magically-just-happen">Things that magically just happen</a>
    <ul>
      <li><a href="https://delph-in.github.io/docs/tools/GrammarPerformance#ambiguity-packing">Ambiguity Packing</a></li>
      <li><a href="https://delph-in.github.io/docs/tools/GrammarPerformance#packing-under-generalization">Packing under Generalization</a></li>
    </ul>
  </li>
</ul>

<!-- markdown-toc end -->

<h1 id="things-to-tweak-for-overall-performance">Things to tweak for overall performance</h1>

<h2 id="quick-check">Quick Check</h2>

<p>Quick check is a method where paths where unifications likely to fail
are checked first, for efficiency. Which unifications are likely to fail
are found by preprocessing a text and seeing which points of failure are
common.</p>

<p>The canonical reference is:</p>

<p>Robert Malouf, John Carroll and Ann Copestake. <a href="http://users.sussex.ac.uk/~johnca/papers/malouf.pdf">Efficient feature structure operations without compilation</a>. <em>Natural Language Engineering</em>, 6(1). 29-46. 2000.</p>

<h3 id="pet">PET</h3>

<p>The file is read in flop.set:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>postload-files := "pet/qc".
</code></pre></div></div>

<p>To make the file, ensure:</p>

<ul>
  <li>you are using compatible versions of flop and cheap</li>
  <li>your grammar is up-to-date</li>
</ul>

<p>See e.g., ${JACY}/utils/make-qc.bash</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mv pet/qc.tdl pet/qc.tdl.old
flop japanese
cat testfile | cheap -limit=100000 -packing -compute-qc=pet/qc.tdl japanese;
flop japanese
</code></pre></div></div>

<p>The testfile must be segmented (e.g., for Japanese)</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>grep -v '#' testsuites/mt-test-set-1.txt | chasen -F "%m " &gt; testfile
</code></pre></div></div>

<p>After you have made the quick check file, you need to rebuild the
grammar.</p>

<p>Note: This is slow, as quick-check is, off course, turned off. In
general, you should use the mode you would normally use (e.g. with
packing if you use packing).</p>

<p>The file is read in when you flop, so add the following to flop.set</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>;; list of files to load after everything else

postload-files := "pet/qc".

;; `pseudo' types outside the type hierarchy. these are ignored for
;; appropriateness, expansion etc.
pseudo-types := 
  $qc_unif_trad $qc_unif_set $qc_subs_trad $qc_subs_set
  $qc_unif_trad_pack $qc_unif_set_pack $qc_subs_trad_pack $qc_subs_set_pack.
</code></pre></div></div>

<h3 id="ace">ACE</h3>

<p>The PET quickcheck file can also be used by ACE.</p>

<p>ACE also has a native quickcheck format, which is read with:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>quickcheck-code           := "../ace/ace-erg-qc.txt".
</code></pre></div></div>

<p>ACE can also produce its quickcheck paths, but currently it is not made
available as a run-time option. In order to produce quickcheck files
from ACE, recompile the ACE code with the gen_qc in ‘chart.c’ option
set to 1, then use that grammar to parse some sentences. At the end, the
quickcheck lines will be printed to stderr.</p>

<p>Note that ACE wants to parse with the same version of the software that
was used to compile a grammar, and the quickcheck producer (being a very
experimental feature) does not work well with grammar compilation, so
you can compile first with gen_qc=0 to produce a version of ACE for
compiling your grammar, then again with gen_qc=1 to produce the version
of ACE used for parsing.</p>

<h3 id="lkb">LKB</h3>

<p>See Copestake (2002: pp 196–197).</p>

<p>The file is read in lkb/script:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(lkb-load-lisp (this-directory) "checkpaths.lsp" t)
</code></pre></div></div>

<p>It is made as follows:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mv lkb/checkpaths.lsp lkb/checkpaths.lsp.old
</code></pre></div></div>

<p>and then from within the *common-lisp* buffer:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(lkb::with-check-path-list-collection 
   "~/delphin/grammars/japanese/lkb/checkpaths.lsp" 
   (parse-sentences 
      "~/delphin/grammars/japanese/testsuites/hinoki-test-a.100" 
      "~/delphin/grammars/japanese/testsuites/hinoki-test-a.100.results"))
</code></pre></div></div>

<h3 id="todo">ToDo</h3>

<ul>
  <li>It would be nice to share the format between PET, LKB and ACE (or
convert)</li>
  <li>It may be worth doing a grid search to optimize how many quick check
paths should actually be checked.
    <ul>
      <li>around 50-60 seems to be ideal</li>
      <li>ACE does something like this</li>
    </ul>
  </li>
</ul>

<h2 id="key-arguments">Key Arguments</h2>

<p>You can gain some performance increase by setting the order in which the
daughters of rules are checked (Oepen &amp; Carroll 2002: pp 204–206). The
order can be specified in the grammar (used by the LKB, ACE and PET) or
in the configuration files for the LKB and PET.</p>

<ul>
  <li>In the grammar</li>
</ul>

<p>Use KEY-ARG and specify it per-rule:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>binary_rule_left_to_right := rule &amp;
  [ ARGS &lt; [ KEY-ARG + ] , [ KEY-ARG bool ] &gt; ].
</code></pre></div></div>

<p>This can then be combined with a rule:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hcomp_rule := binary_rule_left_to_right &amp; head_comp_phrase.
</code></pre></div></div>

<ul>
  <li>In the LKB configuration file</li>
</ul>

<p>lkb/globals.lsp:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(defparameter *rule-keys*
  '((HEAD-ADJUNCT-RULE1 . 1)
    (COMPOUNDS-RULE . 1)
    (KARA-MADE-RULE . 2)
    (HEAD_SUBJ_RULE . 2)
    (HEAD-SPECIFIER-RULE . 2)
    (HEAD-COMPLEMENT-RULE . 2)
    (HEAD-COMPLEMENT2-RULE . 2)
    (HEAD-ADJUNCT-RULE2 . 2)))
</code></pre></div></div>

<ul>
  <li>In the PET configuration file</li>
</ul>

<p>pet/japanese.set:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>;; assoc (rules -&gt; keyarg position) (alternative to KEY-ARG mechanism)
rule-keyargs := 
$HEAD-ADJUNCT-RULE1 1 
$HEAD-ADJUNCT-RULE2 2 
$HEAD-ADJUNCT-RULE3 1 
$RELATIVE-CLAUSE-RULE 1 
$COMPOUNDS-RULE 1 
$SENTENCE-TE-COORDINATION-RULE 1
$CONJ-RULE 1
$KARA-MADE-RULE 2 
$HEAD_SUBJ_RULE 2 
$HEAD-SPECIFIER-RULE 2 
$HEAD-COMPLEMENT-HF-RULE 2 
$HEAD-COMPLEMENT-HI-RULE 1 
$HEAD-COMPLEMENT-AFFIXBIND-RULE 2
$HEAD-COMPLEMENT2-RULE 2 
$HEAD-2OBL-COMPLEMENTS-RULE 2
$VN-LIGHT-RULE 2
$VEND-VEND-RULE 1
$VSTEM-VEND-RULE 2 
$VN-VEND-RULE 2
$PREFIX-ATTACH-RULE 1
$NP-QUEST-FRAG-RULE 2.
</code></pre></div></div>

<p>Key mode in cheap is set with:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>`-key=n' --- select key mode (0=key-driven, 1=l-r, 2=r-l, 3=head-driven)
</code></pre></div></div>

<p>The default is 0.</p>

<p>You get the data by creating two profiles one with -key=1 and one with
key=2, turning on -rulestats. First enable
[Process,switches:write rule relation] in <a href="http://www.delph-in.net/itsdb">[incr
tsdb()]</a>. Use the mode you would
normally use (e.g. with packing if you use packing).</p>

<p>Then [Analyze:rule table] for both profiles and you want to check the
daughter with the least number of active edges (the passive edges should
be the same modulo memory overflow errors).</p>

<h3 id="todo-1">ToDo</h3>

<ul>
  <li>This would be nice to automate</li>
  <li>It would be nice to share the config between PET and the LKB (or
convert)</li>
</ul>

<h2 id="spanning-only-rules">Spanning Only Rules</h2>

<p>You can set rules to only apply over the entire span.
The configuration file syntax for PET is:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>spanning-only-rules := $frg-np $frg-pp $frg-s-adv $frg-i-adv
                       $frg-pp-np $frg-i-adv-np $frg-pp-int 
                       $runon_s.
</code></pre></div></div>

<p>In the ACE config file, a similar option has the same effect (note the
lack of $’s):</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>spanning-only-rules :=
  aj-r_frg_c np-aj_frg_c np-aj_rorp-frg_c
  pp-aj_frg_c j-aj_frg_c np_nb-frg_c np-cl_numitem_c.
</code></pre></div></div>

<p>In the LKB, the equivalent is:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(defparameter *spanning-only-rules*
  '(aj-r_frg_c np-aj_frg_c np-aj_rorp-frg_c
    pp-aj_frg_c j-aj_frg_c np_nb-frg_c np-cl_numitem_c))
</code></pre></div></div>

<p>In one experiment with Jacy, specifying spanning only rules reduced the number of tasks
by 7% and speeded things up by 5%.</p>

<h2 id="trigger-rules-for-generation">Trigger Rules for Generation</h2>

<p>You can control when to add lexical entries with empty semantics to the
generator chart using trigger rules. If they were all added all the time
then the chart would get too big.</p>

<p>See <a href="https://delph-in.github.io/docs/tools/LkbGeneration">LkbGeneration</a> for more discussion (note that
trigger rules also work with <a href="https://delph-in.github.io/docs/tools/AceTop">Ace</a>).</p>

<h2 id="dont-copy-things-you-wont-use">Don’t copy things you won’t use</h2>

<p>In general, you do not want to copy up all the information from lower
nodes in the tree to upper nodes (unless they are specifically linked
with a re-entrancy). You can control what is <strong>not</strong> copied with
deleted daughters. The Matrix sets this to
ARGS HEAD-DTR NON-HEAD-DTR DTR. If you add any more daughters, you
should list them here.</p>

<p>Some examples from the ERG’s ACE config:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>deleted-daughters := 
  ARGS HD-DTR NH-DTR LCONJ-DTR RCONJ-DTR DTR DTR1 DTR2 DTRA DTRB.

parsing-packing-restrictor := 
   RELS HCONS ICONS RNAME +TI +LL +TG.
</code></pre></div></div>

<h2 id="ubertagging">Ubertagging</h2>

<p>Ubertagging is the process of supertagging over ambiguous tokenisation.
This process filters the lexical lattice prior to full parsing according
to a statistical model. It is especially sueful for long sentences.</p>

<p>See the <a href="https://delph-in.github.io/docs/garage/UtTop">Uber Tagging</a> page for more details.</p>

<p>Ubertagging is available for PET and ACE, but needs some set up and
training over a corpus.</p>

<h1 id="things-to-do-to-reduce-noise-during-grammar-engineering">Things to do to reduce noise during grammar engineering</h1>

<p>You can have too many rules, some of which can be annoying if you are
focusing on a different phenomenon. In that case, comment them out and
recompile/reload the grammar. For example, comment out the fragment
rules if you only care for full sentences.</p>

<p>You can also do this with a masking file (so you can have sets of things
you want to ignore). E.g., from the ERG:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cl-cl_runon_c := never_unify_rule.

never_unify_rule := rule &amp;
  [ SYNSEM.LOCAL.CAT.HEAD no_head &amp; [ MINORS.MIN never_unify_rel,
                                      PRD + ],
    ARGS &lt; [ SYNSEM.LOCAL.CAT.HEAD no_head &amp; 
                                   [ MINORS.MIN never_unify_rel,
                                     PRD - ] ] &gt; ].
</code></pre></div></div>

<p>It is worth checking your chart occasionally for chunks you don’t ever
want, and see if you can get rid of unnecessary edges (dark matter).
Removing these will make your life easier and make things run faster.
You need to not be afraid of the chart! It can help to get another
person to look together. Testing with generation is another good way to
spot these.</p>

<p>Also, don’t be afraid of taking some low frequency very ambiguous things
out (e.g. letter <em>I</em> for English, Hiragana <em>は</em> “tooth” for Japanese)
until you are really trying for very high coverage.</p>

<h1 id="things-that-magically-just-happen">Things that magically just happen</h1>

<h2 id="ambiguity-packing">Ambiguity Packing</h2>

<p>See <a href="https://delph-in.github.io/docs/garage/PetSelectiveUnpacking">PetSelectiveUnpacking</a>.</p>

<h2 id="packing-under-generalization">Packing under Generalization</h2>

<p>ACE extends packing under subsumption to allow two edges to pack even
when neither subsumes the other, under some circumstances. Woodley calls
this packing under <strong>generalization</strong> (i.e. an AVM is constructed that
subsumes both).</p>

<p>This can lead to confusing edges in the chart, so it can be a good idea
to turn it off when debugging:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> --disable-generalization
</code></pre></div></div>

<p>Last update: 2022-12-19 by John Carroll [<a href="https://github.com/delph-in/docs/wiki/GrammarPerformance/_edit">edit</a>]</p>

        
      </section>

      <footer class="page__meta">
        
        


        


      </footer>

      

      
    </div>

    
  </article>

  
  
</div>

<!--Scroll the navbar to the current page-->
<script type="text/javascript">
  let el = document.querySelector('.nav__list .active');
  if(el){
    el.scrollIntoView({block: "center", inline: "start"});
  }
</script>
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    
      <li><a href="/docs/tools/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2025 DELPH-IN. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/docs/tools/assets/js/main.min.js"></script>




<script src="/docs/tools/assets/js/lunr/lunr.min.js"></script>
<script src="/docs/tools/assets/js/lunr/lunr-store.js"></script>
<script src="/docs/tools/assets/js/lunr/lunr-en.js"></script>







  </body>
</html>
